# ==================== Basic Sync Config ====================
sync:
  # Basic sync settings
  sync_interval: 300                    # Periodic sync interval (seconds) - 5 minutes
  batch_size: 100                       # Batch processing size
  max_concurrent_tasks: 5               # Max concurrent tasks

  # Retry config
  max_retries: 3                        # Max retry attempts
  retry_delay_base: 2                   # Retry delay base (exponential backoff)
  timeout_seconds: 30                   # Individual task timeout

  # Performance optimization
  enable_compression: true              # Enable data compression
  connection_pool_size: 10              # Connection pool size
  keep_alive_timeout: 60               # Connection keep-alive timeout

  # Sync priority config
  priority_symbols:                     # High priority symbols
    - "NSE:NIFTY"
    - "NSE:BANKNIFTY"
  priority_timeframes:                  # High priority timeframes
    - "1"      # 1 minute
    - "5"      # 5 minutes
    - "15"     # 15 minutes
    - "60"     # 1 hour

# ==================== Data Backup Config ====================
backup:
  # Basic backup settings
  backup_dir: "data/backups"            # Backup directory
  max_backup_files: 30                  # Max backup files to keep
  compression_enabled: true             # Enable compression
  compression_level: 6                  # Compression level (1-9)

  # Backup storage config
  storage:
    local:
      enabled: true
    remote:
      enabled: false                    # Remote backup (optional)
    nas:
      enabled: false                    # Network storage (optional)

  # Backup retention policy
  retention:
    daily_backups: 7                    # Keep 7 daily backups
    weekly_backups: 4                   # Keep 4 weekly backups
    monthly_backups: 12                 # Keep 12 monthly backups
    yearly_backups: 3                   # Keep 3 yearly backups

  # Backup verification config
  verification:
    enable_checksum: true               # Enable checksum verification
    checksum_algorithm: "sha256"        # Checksum algorithm
    enable_integrity_check: true       # Enable integrity check
    verify_after_backup: true          # Verify immediately after backup

# ==================== Scheduled Tasks Config ====================
scheduler:
  enabled: true                         # Enable scheduled tasks
  timezone: "Asia/Shanghai"             # Timezone setting

  # Backup schedule
  backup_tasks:
    # Full backup - 2 AM every day
    - name: "full_backup"
      cron: "0 2 * * *"                # Cron expression
      symbols: ["*"]                    # All symbols
      timeframes: ["*"]                 # All timeframes
      retention_days: 7                 # Retention days
    # Incremental backup - every 30 minutes
    - name: "incremental_backup"
      cron: "0/30 * * * *"
      symbols: ["priority"]             # Priority symbols
    # Snapshot backup - 6, 12, 18 every day
    - name: "snapshot_backup"
      cron: "0 6,12,18 * * *"

  # Sync schedule
  sync_tasks:
    # Main source to cache sync - every 5 minutes
    - name: "source_to_cache"
      cron: "0/5 * * * *"
    # Cache to backup sync - every hour
    - name: "cache_to_backup"
      cron: "0 * * * *"
    # Quality check sync - every 15 minutes
    - name: "quality_check"
      cron: "0/15 * * * *"

# ==================== Monitoring and Alerting Config ====================
monitoring:
  # Basic monitoring
  metrics_port: 9090                    # Prometheus metrics port
  health_check_interval: 60             # Health check interval (seconds)

  # Performance monitoring
  performance:
    sync_speed_threshold: 100           # Sync speed threshold (records/sec)
    backup_time_threshold: 300          # Backup time threshold (seconds)
    cache_hit_rate_threshold: 0.8       # Cache hit rate threshold
    disk_usage_threshold: 0.85          # Disk usage threshold

  # Alerting config
  alerts:
    channels:
      log:
        enabled: true
        level: "WARNING"                # Log level
      email:
        enabled: false                  # Email alerts
      webhook:
        enabled: false                  # Webhook alerts
      prometheus:
        enabled: true                   # Prometheus metrics

  # Alerting rules
  rules:
    - name: "sync_failure_rate"
      threshold: 0.1
      message: "Data sync failure rate too high"
    - name: "backup_failure"
      threshold: 1
      message: "Backup task failed"
    - name: "disk_space_low"
      threshold: 0.9
      message: "Insufficient disk space"
    - name: "data_quality_drop"
      threshold: 0.8
      message: "Data quality degraded"

# ==================== Data Quality Config ====================
quality:
  # Quality assessment thresholds
  thresholds:
    min_completeness: 0.95              # Min completeness
    min_accuracy: 0.90                  # Min accuracy
    min_consistency: 0.85               # Min consistency
    min_timeliness: 0.90                # Min timeliness
    min_validity: 0.95                  # Min validity
    min_uniqueness: 0.99                # Min uniqueness

  # Quality weights
  weights:
    completeness: 0.3
    accuracy: 0.2
    consistency: 0.2
    timeliness: 0.1
    validity: 0.1
    uniqueness: 0.1

  # Data cleaning config
  cleaning:
    auto_fix_price_logic: true          # Auto fix price logic errors
    remove_duplicate_timestamps: true   # Remove duplicate timestamps
    interpolate_missing_values: false   # Interpolate missing values
    outlier_detection: true             # Outlier detection
    outlier_threshold: 3.0              # Outlier threshold (standard deviation multiple)

# ==================== Security Config ====================
security:
  # Access control
  access_control:
    enabled: false                      # Enable auth

  # Data encryption
  encryption:
    enabled: false                      # Enable encryption
    algorithm: "AES-256-GCM"           # Encryption algorithm
    key_rotation_days: 90              # Key rotation days

  # Audit log
  audit:
    enabled: true                       # Enable auditing
    log_file: "logs/audit.log"         # Audit log file
    retention_days: 90                 # Audit log retention days
    # Audit events
    events: ["backup", "sync", "config_change", "delete"]

# ==================== Advanced Config ====================
advanced:
  # Data sharding config
  sharding:
    enabled: false                      # Enable sharding
    shard_size_mb: 100                 # Shard size (MB)
    shard_key: "symbol_timeframe"      # Shard key

  # Data compression config
  compression:
    algorithm: "lz4"                   # Compression algorithm lz4/gzip/zstd
    level: 3                           # Compression level
    threshold_kb: 10                   # Compression threshold (KB)

  # Cache optimization
  cache:
    enable_prefetch: true              # Enable prefetch
    prefetch_window_hours: 24          # Prefetch time window
    enable_adaptive_ttl: true          # Enable adaptive TTL
    min_ttl_minutes: 30                # Min TTL
    max_ttl_hours: 24                  # Max TTL

  # Concurrency control
  concurrency:
    max_sync_workers: 10               # Max sync workers
    max_backup_workers: 3              # Max backup workers
    rate_limit_per_second: 100         # Requests per second limit
    connection_timeout: 30             # Connection timeout

# ==================== Dev/Debug Config ====================
development:
  # Debug mode
  debug_mode: false                     # Debug mode
  verbose_logging: false               # Verbose logging
  profile_performance: false           # Performance profiling

  # Test config
  test_mode: false                     # Test mode
  mock_data: false                     # Use mock data
  dry_run: false                       # Dry run mode

  # Dev tools
  enable_debug_api: false              # Enable debug API
  debug_api_port: 8080                 # Debug API port
  enable_metrics_dashboard: false      # Enable metrics dashboard
